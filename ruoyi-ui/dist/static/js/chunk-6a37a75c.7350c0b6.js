(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6a37a75c"],{"1dc9":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"app-container"},[n("el-row",{attrs:{gutter:20}},[n("el-col",{attrs:{span:24,xs:24}},[n("el-row",{staticClass:"mb8",attrs:{gutter:10}},[n("el-col",{attrs:{span:1.5}},[n("el-button",{attrs:{type:"primary",plain:"",icon:"el-icon-plus",size:"mini"},on:{click:t.handleAdd}},[t._v("新增 ")])],1)],1),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{data:t.userList},on:{"selection-change":t.handleSelectionChange}},[n("el-table-column",{attrs:{type:"selection",width:"50",align:"center"}}),n("el-table-column",{key:"id",attrs:{label:"编号",align:"center",prop:"id"}}),n("el-table-column",{key:"name",attrs:{label:"名称",align:"center",prop:"name","show-overflow-tooltip":!0}}),n("el-table-column",{key:"count",attrs:{label:"数量",align:"center",prop:"count","show-overflow-tooltip":!0}}),n("el-table-column",{key:"image",attrs:{label:"预览",align:"center",prop:"image"},scopedSlots:t._u([{key:"default",fn:function(t){return[n("img",{staticStyle:{height:"40px",width:"40px"},attrs:{src:t.row.image}})]}}])}),n("el-table-column",{attrs:{label:"创建时间",align:"center",prop:"createTime",width:"160"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(t._s(t.parseTime(e.row.createTime)))])]}}])}),n("el-table-column",{attrs:{label:"操作",align:"center",width:"160","class-name":"small-padding fixed-width"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-edit"},on:{click:function(n){return t.handleUpdate(e.row)}}},[t._v("修改 ")]),n("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-delete"},on:{click:function(n){return t.handleDelete(e.row)}}},[t._v("删除 ")])]}}])})],1),n("pagination",{directives:[{name:"show",rawName:"v-show",value:t.total>0,expression:"total>0"}],attrs:{total:t.total,page:t.queryParams.pageNum,limit:t.queryParams.pageSize},on:{"update:page":function(e){return t.$set(t.queryParams,"pageNum",e)},"update:limit":function(e){return t.$set(t.queryParams,"pageSize",e)},pagination:t.getList}})],1)],1),n("el-dialog",{attrs:{title:t.title,visible:t.open,width:"600px","append-to-body":""},on:{"update:visible":function(e){t.open=e}}},[n("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules,"label-width":"80px"}},[n("el-row",[n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"奖品名称",prop:"name"}},[n("el-input",{attrs:{placeholder:"请输入奖品名称",maxlength:"300"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1)],1)],1),n("el-row",[n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"数量",prop:"count"}},[n("el-input",{attrs:{placeholder:"请输入数量",maxlength:"5"},model:{value:t.form.count,callback:function(e){t.$set(t.form,"count",e)},expression:"form.count"}})],1)],1)],1),n("el-row",[n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"奖品图片",prop:"image"}},[n("el-upload",{ref:"upload",attrs:{limit:1,accept:".jpg, .png",headers:t.upload.headers,action:t.upload.url,disabled:t.upload.isUploading,"on-progress":t.handleFileUploadProgress,"on-success":t.handleFileSuccess,"auto-upload":!1,drag:""}},[n("i",{staticClass:"el-icon-upload"}),n("div",{staticClass:"el-upload__text"},[t._v("将文件拖到此处，或"),n("em",[t._v("点击上传")])])])],1)],1)],1)],1),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary"},on:{click:t.submitForm}},[t._v("确 定")]),n("el-button",{on:{click:t.cancel}},[t._v("取 消")])],1)],1),n("el-dialog",{attrs:{title:t.upload.title,visible:t.upload.open,width:"400px","append-to-body":""},on:{"update:visible":function(e){return t.$set(t.upload,"open",e)}}},[n("el-upload",{ref:"upload",attrs:{limit:1,accept:".jpg, .png, .gif",headers:t.upload.headers,action:t.upload.url+"?updateSupport="+t.upload.updateSupport,disabled:t.upload.isUploading,"on-progress":t.handleFileUploadProgress,"on-success":t.handleFileSuccess,"auto-upload":!1,drag:""}},[n("i",{staticClass:"el-icon-upload"}),n("div",{staticClass:"el-upload__text"},[t._v("将文件拖到此处，或"),n("em",[t._v("点击上传")])])]),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary"},on:{click:t.submitFileForm}},[t._v("确 定")]),n("el-button",{on:{click:function(e){t.upload.open=!1}}},[t._v("取 消")])],1)],1)],1)},o=[],r=n("5530"),s=(n("4de4"),n("d3b7"),n("d81d"),n("14d9"),n("c0c7")),i=n("5f87"),l=n("ca17"),u=n.n(l),d=(n("542c"),n("707b")),c={name:"User",dicts:["sys_normal_disable","sys_user_sex"],components:{Treeselect:u.a},data:function(){return{loading:!0,ids:[],single:!0,multiple:!0,showSearch:!0,total:0,userList:null,title:"",deptOptions:void 0,open:!1,deptName:void 0,initPassword:void 0,dateRange:[],postOptions:[],roleOptions:[],form:{},defaultProps:{children:"children",label:"label"},upload:{open:!1,title:"",isUploading:!1,updateSupport:0,headers:{Authorization:"Bearer "+Object(i["a"])()},url:"http://139.180.213.111:8080//lottery/goods/uploadGoods"},queryParams:{pageNum:1,pageSize:10,userName:void 0,phonenumber:void 0,status:void 0,deptId:void 0},columns:[{key:0,label:"奖品编号",visible:!0},{key:1,label:"奖品名称",visible:!0},{key:2,label:"奖品昵称",visible:!0},{key:3,label:"部门",visible:!0},{key:4,label:"手机号码",visible:!0},{key:5,label:"状态",visible:!0},{key:6,label:"创建时间",visible:!0}],rules:{userName:[{required:!0,message:"奖品名称不能为空",trigger:"blur"},{min:2,max:20,message:"奖品名称长度必须介于 2 和 20 之间",trigger:"blur"}],nickName:[{required:!0,message:"奖品昵称不能为空",trigger:"blur"}],password:[{required:!0,message:"奖品密码不能为空",trigger:"blur"},{min:5,max:20,message:"奖品密码长度必须介于 5 和 20 之间",trigger:"blur"}],email:[{type:"email",message:"请输入正确的邮箱地址",trigger:["blur","change"]}],phonenumber:[{pattern:/^1[3|4|5|6|7|8|9][0-9]\d{8}$/,message:"请输入正确的手机号码",trigger:"blur"}]}}},watch:{deptName:function(t){this.$refs.tree.filter(t)}},created:function(){var t=this;this.getList(),this.getDeptTree(),this.getConfigKey("sys.user.initPassword").then((function(e){t.initPassword=e.msg}))},methods:{getList:function(){var t=this;this.loading=!0,Object(d["e"])(this.addDateRange(this.queryParams,this.dateRange)).then((function(e){t.userList=e.rows,t.total=e.total,t.loading=!1}))},getDeptTree:function(){var t=this;Object(s["d"])().then((function(e){t.deptOptions=e.data}))},filterNode:function(t,e){return!t||-1!==e.label.indexOf(t)},handleNodeClick:function(t){this.queryParams.deptId=t.id,this.handleQuery()},handleStatusChange:function(t){var e=this,n="0"===t.status?"启用":"停用";this.$modal.confirm('确认要"'+n+'""'+t.userName+'"奖品吗？').then((function(){return Object(s["b"])(t.userId,t.status)})).then((function(){e.$modal.msgSuccess(n+"成功")})).catch((function(){t.status="0"===t.status?"1":"0"}))},cancel:function(){this.open=!1,this.reset()},reset:function(){this.form={id:void 0,name:void 0,count:0,image:void 0,status:"0"},this.resetForm("form")},handleQuery:function(){this.queryParams.pageNum=1,this.getList()},resetQuery:function(){this.dateRange=[],this.resetForm("queryForm"),this.queryParams.deptId=void 0,this.$refs.tree.setCurrentKey(null),this.handleQuery()},handleSelectionChange:function(t){this.ids=t.map((function(t){return t.userId})),this.single=1!=t.length,this.multiple=!t.length},handleCommand:function(t,e){switch(t){case"handleResetPwd":this.handleResetPwd(e);break;case"handleAuthRole":this.handleAuthRole(e);break;default:break}},handleAdd:function(){var t=this;this.reset(),Object(s["f"])().then((function(e){t.postOptions=e.posts,t.roleOptions=e.roles,t.open=!0,t.title="添加奖品",t.form.password=t.initPassword}))},handleUpdate:function(t){var e=this;this.reset();var n=t.id||this.ids;Object(d["c"])(n).then((function(t){e.form=t.data,e.open=!0,e.title="修改奖品"}))},handleResetPwd:function(t){var e=this;this.$prompt('请输入"'+t.userName+'"的新密码',"提示",{confirmButtonText:"确定",cancelButtonText:"取消",closeOnClickModal:!1,inputPattern:/^.{5,20}$/,inputErrorMessage:"奖品密码长度必须介于 5 和 20 之间"}).then((function(n){var a=n.value;Object(s["i"])(t.userId,a).then((function(t){e.$modal.msgSuccess("修改成功，新密码是："+a)}))})).catch((function(){}))},handleAuthRole:function(t){var e=t.userId;this.$router.push("/system/user-auth/role/"+e)},submitForm:function(){this.$refs.upload.submit(),void 0!=this.form.id&&void 0!=this.form.image&&this.trueSubmit()},handleDelete:function(t){var e=this,n=t.id||this.ids;this.$modal.confirm('是否确认删除奖品编号为"'+n+'"的数据项？').then((function(){return Object(d["b"])(n)})).then((function(){e.getList(),e.$modal.msgSuccess("删除成功")})).catch((function(){}))},handleExport:function(){this.download("system/user/export",Object(r["a"])({},this.queryParams),"user_".concat((new Date).getTime(),".xlsx"))},handleImport:function(){this.upload.title="奖品导入",this.upload.open=!0},importTemplate:function(){this.download("system/user/importTemplate",{},"user_template_".concat((new Date).getTime(),".xlsx"))},handleFileUploadProgress:function(t,e,n){this.upload.isUploading=!0},handleFileSuccess:function(t,e,n){this.upload.open=!1,this.form.image=t.msg,this.upload.isUploading=!1,this.$refs.upload.clearFiles(),this.$alert("<div style='overflow: auto;overflow-x: hidden;max-height: 70vh;padding: 10px 20px 0;'>"+t.msg+"</div>","上传结果",{dangerouslyUseHTMLString:!0}),this.trueSubmit()},trueSubmit:function(){var t=this;this.$refs["form"].validate((function(e){e&&(void 0!=t.form.id?Object(d["f"])(t.form).then((function(e){t.$modal.msgSuccess("修改成功"),t.open=!1,t.getList()})):Object(d["a"])(t.form).then((function(e){t.$modal.msgSuccess("新增成功"),t.open=!1,t.getList()})))}))},submitFileForm:function(){this.$refs.upload.submit()}}},p=c,m=n("2877"),h=Object(m["a"])(p,a,o,!1,null,null,null);e["default"]=h.exports},"707b":function(t,e,n){"use strict";n.d(e,"e",(function(){return r})),n.d(e,"a",(function(){return s})),n.d(e,"c",(function(){return i})),n.d(e,"d",(function(){return l})),n.d(e,"f",(function(){return u})),n.d(e,"b",(function(){return d}));var a=n("b775"),o=n("c38a");function r(t){return Object(a["a"])({url:"/lottery/goods/list",method:"get",params:t})}function s(t){return Object(a["a"])({url:"/lottery/goods",method:"post",data:t})}function i(t){return Object(a["a"])({url:"/lottery/goods/"+Object(o["e"])(t),method:"get"})}function l(t){return Object(a["a"])({url:"/lottery/goods/getGoodsByName",data:{name:t},method:"post"})}function u(t){return Object(a["a"])({url:"/lottery/goods",method:"put",data:t})}function d(t){return Object(a["a"])({url:"/lottery/goods/"+t,method:"delete"})}},c0c7:function(t,e,n){"use strict";n.d(e,"h",(function(){return r})),n.d(e,"f",(function(){return s})),n.d(e,"a",(function(){return i})),n.d(e,"k",(function(){return l})),n.d(e,"c",(function(){return u})),n.d(e,"i",(function(){return d})),n.d(e,"b",(function(){return c})),n.d(e,"g",(function(){return p})),n.d(e,"l",(function(){return m})),n.d(e,"m",(function(){return h})),n.d(e,"n",(function(){return f})),n.d(e,"e",(function(){return g})),n.d(e,"j",(function(){return b})),n.d(e,"d",(function(){return v}));var a=n("b775"),o=n("c38a");function r(t){return Object(a["a"])({url:"/system/user/list",method:"get",params:t})}function s(t){return Object(a["a"])({url:"/system/user/"+Object(o["e"])(t),method:"get"})}function i(t){return Object(a["a"])({url:"/system/user",method:"post",data:t})}function l(t){return Object(a["a"])({url:"/system/user",method:"put",data:t})}function u(t){return Object(a["a"])({url:"/system/user/"+t,method:"delete"})}function d(t,e){var n={userId:t,password:e};return Object(a["a"])({url:"/system/user/resetPwd",method:"put",data:n})}function c(t,e){var n={userId:t,status:e};return Object(a["a"])({url:"/system/user/changeStatus",method:"put",data:n})}function p(){return Object(a["a"])({url:"/system/user/profile",method:"get"})}function m(t){return Object(a["a"])({url:"/system/user/profile",method:"put",data:t})}function h(t,e){var n={oldPassword:t,newPassword:e};return Object(a["a"])({url:"/system/user/profile/updatePwd",method:"put",params:n})}function f(t){return Object(a["a"])({url:"/system/user/profile/avatar",method:"post",data:t})}function g(t){return Object(a["a"])({url:"/system/user/authRole/"+t,method:"get"})}function b(t){return Object(a["a"])({url:"/system/user/authRole",method:"put",params:t})}function v(){return Object(a["a"])({url:"/system/user/deptTree",method:"get"})}}}]);